{"version":3,"sources":["../../src/pages/modals/speech-modal/speech-modal.module.ts","../../src/pages/modals/speech-modal/speech-modal.ts","../../src/components/progress-bar/progress-bar.module.ts","../../src/components/progress-bar/progress-bar.ts"],"names":[],"mappings":"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","file":"3.js","sourcesContent":["import {NgModule} from '@angular/core';\nimport {IonicPageModule} from 'ionic-angular';\nimport {SpeechModalPage} from './speech-modal';\nimport {ProgressBarComponentModule} from \"../../../components/progress-bar/progress-bar.module\";\n\n@NgModule({\n    declarations: [\n        SpeechModalPage,\n    ],\n    imports: [\n        IonicPageModule.forChild(SpeechModalPage),\n        ProgressBarComponentModule\n    ],\n    exports: [\n        SpeechModalPage\n    ]\n})\nexport class SpeechModalPageModule {\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modals/speech-modal/speech-modal.module.ts","import {Component} from '@angular/core';\nimport {IonicPage, App, NavController, NavParams, ViewController, Platform} from 'ionic-angular';\nimport {SpeechRecognition, SpeechRecognitionListeningOptions} from '@ionic-native/speech-recognition';\nimport {ChangeDetectorRef} from '@angular/core';\nimport {General} from '../../../general/general';\nimport {TabsPage} from \"../../tabs/tabs\";\nimport {Diagnostic} from \"@ionic-native/diagnostic\";\nimport {GlobalVariables} from \"../../../general/global-variables\";\n\n@IonicPage()\n@Component({\n  selector: 'page-speech-modal',\n  templateUrl: 'speech-modal.html',\n})\nexport class SpeechModalPage {\n\n    match:any = '';\n    isRecording:boolean = false;\n    doneRecording:boolean = true;\n    hasResults:boolean = false;\n    hideProgress:boolean = false;\n    samePageSearch:boolean = false;\n    timer:number = 0;\n    interval:any;\n    isAndroid:any;\n\n  constructor(\n      public navCtrl: NavController,\n      public diagnostic: Diagnostic,\n      public navParams: NavParams,\n      public viewCtrl: ViewController,\n      public app: App,\n      public speechRecognition: SpeechRecognition,\n      public globalVariables: GlobalVariables,\n      public platform: Platform,\n      public general: General,\n      private cd: ChangeDetectorRef\n  ) {\n      this.match = '';\n  }\n\n    ionViewDidLoad() {\n        this.getPermission();\n\n        this.samePageSearch = this.navParams.get('samePageSearch') || false;\n\n        this.isAndroid = this.platform.is('android') || false;\n\n        this.match = null;\n        //\n        // let interval = setInterval(() => {\n        //     this.hasResults = true;\n        //\n        //     this.timer++;\n        //     if(this.timer === 100){\n        //         clearInterval(interval);\n        //         this.hideProgress =  true;\n        //     }\n        // }, 50);\n    }\n\n    stopListening() {\n        this.speechRecognition.stopListening().then(() => {\n            this.isRecording = false;\n            this.doneRecording = true;\n            clearInterval(this.interval);\n            this.timer = 0;\n            this.cd.detectChanges();\n        });\n    }\n\n    getPermission() {\n        this.speechRecognition.hasPermission()\n            .then((hasPermission: boolean) => {\n                if (!hasPermission) {\n                    this.speechRecognition.requestPermission();\n                    this.diagnostic.requestMicrophoneAuthorization();\n                } else {\n                    this.startListening();\n                }\n            });\n    }\n\n    startListening() {\n\n        if (!this.globalVariables.isConnected) {\n            this.general.showNetworkConnectionAlert();\n            this.cancel();\n            return;\n        }\n\n        let options: SpeechRecognitionListeningOptions = {\n            language: 'es-MX',\n            showPopup: false,\n            showPartial: true\n        };\n\n        this.isRecording = true;\n        this.doneRecording = false;\n        this.hideProgress = false;\n        this.hasResults = false;\n        let doSearch = false;\n        this.timer = 0;\n\n        clearInterval(this.interval);\n        this.interval = null;\n        this.cd.detectChanges();\n\n        this.speechRecognition.startListening(options).subscribe(matches => {\n            if (matches.length > 0) {\n                console.log('matches.length  ' + matches.length)\n                this.match = matches[0];\n                console.log('this.match ' + this.match);\n                this.hasResults = matches.length > 0 ? true : false;\n                doSearch = this.hasResults;\n                if (this.hasResults && doSearch) {\n                    this.timer = 0;\n                    this.interval = setInterval(() => {\n                        if (doSearch && this.isRecording && this.interval) {\n                            this.timer++;\n                        }\n                        if (this.timer === 100) {\n                            this.hideProgress = true;\n                            if (matches[0] && this.match !== 'No hemos detectado resultados') {\n                                clearInterval(this.interval);\n                                this.searchPlace();\n                                doSearch = false;\n                            }\n                        }\n                        this.cd.detectChanges();\n                    }, 50);\n                }\n                this.cd.detectChanges();\n            }\n\n        }, (error) => {\n            console.log(error);\n            if (!this.match) {\n                this.match = 'No hemos detectado resultados';\n            }\n            this.hasResults = false;\n            this.cd.detectChanges();\n        });\n\n        setTimeout(() => {\n            if (this.isRecording && !this.hasResults) {\n                this.stopListening();\n            }\n        }, 8000)\n\n    }\n\n    cancel() {\n        this.timer = 0;\n        this.match = '';\n        this.stopListening();\n        this.viewCtrl.dismiss()\n    }\n\n    searchPlace() {\n        if (this.match) {\n            this.timer = 0;\n            let search = this.general.removeAccents(this.match);\n            this.stopListening();\n            if (this.samePageSearch) {\n                this.viewCtrl.dismiss(search);\n            } else {\n                this.viewCtrl.dismiss();\n                setTimeout(() => {\n                    let nav = this.app.getRootNav();\n                    nav.setRoot(TabsPage, {search: search, tabIndex: 2});\n                }, 400);\n            }\n        }\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modals/speech-modal/speech-modal.ts","import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ProgressBarComponent } from './progress-bar';\n\n@NgModule({\n  declarations: [\n    ProgressBarComponent,\n  ],\n  imports: [\n    IonicPageModule.forChild(ProgressBarComponent),\n  ],\n  exports: [\n    ProgressBarComponent\n  ]\n})\nexport class ProgressBarComponentModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/progress-bar/progress-bar.module.ts","import {Component, Input} from '@angular/core';\n\n@Component({\n    selector: 'progress-bar',\n    templateUrl: 'progress-bar.html'\n})\nexport class ProgressBarComponent {\n\n    @Input('progress') progress;\n\n    constructor() {\n\n    }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/progress-bar/progress-bar.ts"],"sourceRoot":""}